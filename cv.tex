\documentclass[a4paper,11pt]{moderncv}

\firstname{Michael}
\familyname{Walker}
\address{York, North Yorkshire, England}
\phone[mobile]{(+44) (0) 7966875255}
\email{mike@barrucadu.co.uk}
\homepage{www.barrucadu.co.uk}
\social[linkedin]{barrucadu}
\social[twitter]{barrucadu}
\social[github]{barrucadu}
\extrainfo{GPG: 9F58FC68}

% Fonts
\usepackage{fontspec}

\defaultfontfeatures{Mapping=tex-text}
\setmainfont[SmallCapsFont = Fontin SmallCaps]{Fontin}

% Layout
\moderncvstyle{casual}
\moderncvcolor{blue}
\setlength{\hintscolumnwidth}{3cm}

\usepackage[big]{layaureo}

% moderncv patches

\makeatletter
\RenewDocumentCommand{\section}{sm}{%
  \par\addvspace{2.5ex}%
  \phantomsection{}%
  \addcontentsline{toc}{section}{#2}%
  \cvitem[0ex]{\strut\raggedleft\raisebox{\baseletterheight}{\color{color1}\rule{\hintscolumnwidth}{0.33ex}}}{\strut\sectionstyle{#2}}%
  \par\nobreak\addvspace{1ex}\@afterheading}
\makeatother

\renewcommand*{\cventry}[7][.25em]{%
  \cvitem[#1]{\itshape#2}{%
    {\bfseries#3}%
    \ifthenelse{\equal{#4}{}}{}{, #4}%
    \ifthenelse{\equal{#5}{}}{}{, {\itshape#5}}.%
    \ifthenelse{\equal{#6}{}}{}{\hfill\href{#6}{#6}}%
    \strut%
    \ifx&#7&%
    \else{\newline{}\begin{minipage}[t]{\linewidth}\small#7\end{minipage}}\fi}}

% Links
\AfterPreamble{
  \definecolor{linkcolour}{rgb}{0.1,0.3,0.45}
  \hypersetup{colorlinks,breaklinks,urlcolor=linkcolour,linkcolor=linkcolour}
}

% \published{year}{title}{publisher}{authors}{venue}
\newcommand{\published}[5]{\cventry{#3}{#1}{#2}{}{}{#4. In \textit{#5}.}}

% \employed{dates}{title}{organisation}{location}{description}
\newcommand{\employed}[5]{\cventry{#3}{#1}{#2}{#4}{}{#5}}

% \educated{dates}{level}{institute}{grade}{description}
\newcommand{\educated}[5]{\cventry{#3}{#1}{#2}{#4}{}{#5}}

% \contribution{dates}{title}{name}{url}{description}
\newcommand{\contribution}[5]{\cventry{#3}{#1}{#2}{}{#4}{#5}}

% \project{title}{url}{summary}{description}
\newcommand{\project}[4]{\cventry{#1}{#3}{}{}{#2}{#4}}

\begin{document}

\begin{center}
  \makeatletter
  \namestyle{\@firstname\ \textsc{\@lastname}}
  \makeatother
\end{center}

\makecvfoot

\section{\scshape Publications}

\published{Sep 2015}
  {Déjà Fu: A Concurrency Testing Library for Haskell}
  {ACM SIGPLAN}
  {Michael Walker and Colin Runciman}
  {ACM SIGPLAN Symposium on Haskell}

\section{\scshape Employment}

\employed{Oct 2015--present}
  {Postgraduate Teaching Assistant}
  {University of York}
  {York}
  {Assist with the teaching of first-year introductory programming course.}

\employed{Oct 2014--Jun 2015}
  {Postgraduate Teaching Assistant}
  {University of York}
  {York}
  {Assisted with the teaching of first-year introductory discrete mathematics course.}

\employed{Jul--Sep 2014}
  {Software Engineering Intern}
  {CoreFiling}
  {Oxford}
  {Refactored an in-house wiki program, Reviki, in particular the
    development of a parser/renderer using ANTLR in Java and the
    integration of this renderer with JIRA.}

\section{\scshape Education}

\educated{2014--present}
  {Doctor of Philosophy}
  {University of York}
  {}
  {Expected to graduate in 2017.}

\educated{2010--2014}
  {Master of Engineering}
  {University of York}
  {achieved 2:1}
  {Dissertation on verification of stop-the-world garbage collectors.}

\section{\scshape Projects}

\subsection{\bfseries Free Software Contributions}

\contribution{2010--2015}
  {Project Leader}
  {Arch Hurd}
  {http://www.archhurd.org}
  {Packaged and maintained software, managed small development team,
    produced bootable installation media. Currently maintain website
    and server.}

\contribution{2009}
  {Developer}
  {Uzbl}
  {http://www.uzbl.org}
  {Helped with the implementation of early-stage functionality in a
    small development team.}

\vspace{0.2cm}
\subsection{\bfseries Personal}

\project{BookDB}
  {https://github.com/barrucadu/bookdb}
  {Personal library webapp}
  {Maintains a database of books, keeping track of information such as
    the location and borrower of each book, and presents some
    statistics. Written in Haskell.}

\project{yukibot}
  {https://github.com/barrucadu/yukibot}
  {IRC bot}
  {A concurrent IRC bot capable of connecting to multiple
   networks simultaneously and responding to commands and events as
   they arise.}

\end{document}
